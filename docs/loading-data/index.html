<!doctype html>
<!--[if lt IE 7 ]><html itemscope itemtype="http://schema.org/Organization" id="ie6" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 7 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie7" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 8 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie8" class="ie ie-old" lang="en-US"><![endif]-->
<!--[if IE 9 ]>   <html itemscope itemtype="http://schema.org/Organization" id="ie9" class="ie" lang="en-US"><![endif]-->
<!--[if gt IE 9]><!--><html itemscope itemtype="http://schema.org/Organization" lang="en-US"><!--<![endif]-->
<head>

    <!-- Meta -->
    <meta charset="utf-8">
    <title>Loading Data - MarkLogic Unit Test</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <!-- Favicons -->
    <link rel="shortcut icon" sizes="16x16 24x24 32x32 48x48 64x64 96x96" href="/marklogic-unit-test/favicon.ico">
    <meta name="application-name" content="MarkLogic Unit Test - A Unit Test framework for MarkLogic">
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-6638631-15', 'auto');
      ga('send', 'pageview');

    </script>

    <!-- Facebook Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
    n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
    document,'script','https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1879746318909687'); // Insert your pixel ID here.
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1879746318909687&ev=PageView&noscript=1"
    /></noscript>
    <!-- DO NOT MODIFY -->
    <!-- End Facebook Pixel Code -->
    <link type="text/css" rel="stylesheet" href="/marklogic-unit-test/assets/bundle.css">
</head>
<body class="">

    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/marklogic-unit-test">
                  <span class="logo">
                    <img src="/marklogic-unit-test/images/logo-marklogic.svg" width="180px" height="38px" alt="MarkLogic" title="MarkLogic" scale="0">
                  </span>
                  MarkLogic Unit Test
                </a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    
                        <li  >
                            
                            <a href="/marklogic-unit-test/">Getting Started</a>
                            
                        </li>
                    
                        <li  >
                            
                            <a href="https://github.com/marklogic-community/marklogic-unit-test">GitHub</a>
                            
                        </li>
                    
                </ul>
            </div>
        </div>
    </nav>




  <article>
    <div class="container">
      <div class="row">
        <div class="side-nav col-md-3 hide-small">
          <div class="panel panel-default">
  <div class="panel-heading">Navigation</div>
  <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/">Getting Started</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/include/">How to Include MarkLogic Unit Test in Your Project</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/running/">How to Run Your Tests</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/docs/">Docs</a>
    
    
      <ul class="list-group">
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/docs/conventions/">Filename Conventions</a>
    
    
  </li>
  
  <li  class="list-group-item active"  >
    
    <a href="/marklogic-unit-test/docs/loading-data/">Loading Data</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/docs/testing-with-sjs/">Testing With JavaScript</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/docs/testing-with-xquery/">Testing With XQuery</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/docs/assertions/">Assert Functions</a>
    
    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="/marklogic-unit-test/docs/transactional/">Transactional Unit Tests</a>
    
    
  </li>
  
</ul>

    
  </li>
  
  <li  class="list-group-item"  >
    
    <a href="https://github.com/marklogic-community/marklogic-unit-test">MarkLogic Unit Test on GitHub</a>
    
    
  </li>
  
</ul>

</div>

        </div>
        <div class="col-md-9">
          <h2 id="loading-data">Loading Data</h2>

<p>MarkLogic Unit Test simplifies loading data for your tests. Files to be loaded can be placed in a sub-directory of your test suite called <code class="highlighter-rouge">test-data</code>. The test helper provides a function which will automatically use this directory as the location of test files to be loaded.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>test:load-data-file(&lt;name-of-file-to-be-loaded-without-path&gt;,database id, &lt;URI&gt;)
</code></pre></div></div>

<p>Suppose our test suite has a <code class="highlighter-rouge">lib/lib.xqy</code> file that declares a variable <code class="highlighter-rouge">$URI</code> with the value “/test-article.xml”. Our
setup script could look like this in JavaScript:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">test</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"/test/test-helper.xqy"</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">lib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"lib/lib.xqy"</span><span class="p">);</span>

<span class="nx">test</span><span class="p">.</span><span class="nx">loadTestFile</span><span class="p">(</span><span class="s2">"test-article.xml"</span><span class="p">,</span> <span class="nx">xdmp</span><span class="p">.</span><span class="nx">database</span><span class="p">(),</span> <span class="nx">lib</span><span class="p">.</span><span class="nx">URI</span><span class="p">);</span>
</code></pre></div></div>

<p>… and in XQuery:</p>

<div class="language-xquery highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kp">import</span> <span class="kp">module</span> <span class="k">namespace</span> <span class="nn">test</span> <span class="o">=</span> <span class="s2">"http://marklogic.com/test"</span> <span class="k">at</span> <span class="s2">"/test/test-helper.xqy"</span><span class="p">;</span>
<span class="kp">import</span> <span class="kp">module</span> <span class="k">namespace</span> <span class="nn">lib</span> <span class="o">=</span> <span class="s2">"http://example.com/test/lib"</span> <span class="k">at</span> <span class="s2">"lib/lib.xqy"</span><span class="p">;</span>

<span class="nf">test:load-test-file</span><span class="p">(</span><span class="s2">"test-article.xml"</span><span class="p">,</span> <span class="nf">xdmp:database</span><span class="p">(),</span> <span class="nv">$</span><span class="n">lib:URI</span><span class="p">)</span>
</code></pre></div></div>

<p>The first parameter should be set to the filename without any path elements.</p>

<p>The database id can be determined by using the API <code class="highlighter-rouge">xdmp:database()</code>. You can also specify the name of the database as in input string to this function if need be. The URI will be the URI of the file in the database.</p>

<p>This should be included in the appropriate suite or test setup JavaScript or XQuery file. In the corresponding 
teardown, remove the data files by referring to the URI.</p>

<p>teardown.sjs:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">lib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"lib/lib.xqy"</span><span class="p">);</span>

<span class="nx">xdmp</span><span class="p">.</span><span class="nx">documentDelete</span><span class="p">(</span><span class="nx">lib</span><span class="p">.</span><span class="nx">URI</span><span class="p">);</span>
</code></pre></div></div>

<p>teardown.xqy:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import module namespace lib = "http://example.com/test/lib" at "lib/lib.xqy";

xdmp:document-delete($lib:URI)
</code></pre></div></div>

<p>When loading data you</p>
<ul>
  <li>create the data in the <code class="highlighter-rouge">test-data</code> subdir mentioned above</li>
  <li>then load the data (and any test modules) by running <code class="highlighter-rouge">gradle mlLoadModuels</code>. This loads all modules, including the data files.</li>
  <li>at runtime the test data is loaded into your test-content-db from the modules database (or filesystem if you are running out of the filesystem).</li>
</ul>


        </div>
      </div>
    </div>
  </article>


    <footer class="site-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <p>
                    Copyright © 2016-2023 MarkLogic Corporation. All Rights Reserved. MARKLOGIC® is a registered trademark of MarkLogic Corporation.
                    </p>
                </div>
            </div>
        </div>
    </footer>


    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="/marklogic-unit-test/js/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="/marklogic-unit-test/assets/bundle.js" id="1"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79716597-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>

